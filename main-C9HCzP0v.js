import{r as d,j as e,C as F,u as R,T as h,B as W,S as U,P as X,R as A,c as V}from"./three-B0kUcY50.js";import"./vendor-9sitkZcQ.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const q=`
struct VertexInput {
  @location(0) position: vec3<f32>,
  @location(1) normal: vec3<f32>,
  @location(2) uv: vec2<f32>,
}

struct VertexOutput {
  @builtin(position) clip_position: vec4<f32>,
  @location(0) world_position: vec3<f32>,
  @location(1) normal: vec3<f32>,
  @location(2) uv: vec2<f32>,
}

struct Uniforms {
  view_proj: mat4x4<f32>,
  model: mat4x4<f32>,
  time: f32,
  light_position: vec3<f32>,
}

@group(0) @binding(0)
var<uniform> uniforms: Uniforms;

@vertex
fn vs_main(input: VertexInput) -> VertexOutput {
  var out: VertexOutput;
  
  let world_position = uniforms.model * vec4<f32>(input.position, 1.0);
  out.world_position = world_position.xyz;
  out.clip_position = uniforms.view_proj * world_position;
  out.normal = normalize((uniforms.model * vec4<f32>(input.normal, 0.0)).xyz);
  out.uv = input.uv;
  
  return out;
}
`,H=`
struct FragmentInput {
  @location(0) world_position: vec3<f32>,
  @location(1) normal: vec3<f32>,
  @location(2) uv: vec2<f32>,
}

struct Uniforms {
  view_proj: mat4x4<f32>,
  model: mat4x4<f32>,
  time: f32,
  light_position: vec3<f32>,
}

@group(0) @binding(0)
var<uniform> uniforms: Uniforms;

@group(0) @binding(1)
var texture_sampler: sampler;

@group(0) @binding(2)
var metallic_texture: texture_2d<f32>;

@fragment
fn fs_main(input: FragmentInput) -> @location(0) vec4<f32> {
  let uv = input.uv;
  let world_pos = input.world_position;
  let normal = normalize(input.normal);

  // Sample metallic texture for base color
  var base_color = textureSample(metallic_texture, texture_sampler, uv).rgb;

  // Lighting calculation
  let light_dir = normalize(uniforms.light_position - world_pos);
  let view_dir = normalize(-world_pos); // Assuming camera at origin
  let half_dir = normalize(light_dir + view_dir);

  // Diffuse lighting
  let diffuse = max(0.0, dot(normal, light_dir));

  // Specular lighting (stronger for metallic)
  let specular = pow(max(0.0, dot(normal, half_dir)), 64.0) * 0.5;

  // Ambient lighting
  let ambient = 0.4;

  // Final color composition
  let final_color = base_color * (ambient + diffuse * 0.7) + vec3<f32>(specular);

  return vec4<f32>(final_color, 1.0);
}
`;class ${device;pipeline=null;uniformBuffer=null;metallicTexture=null;bindGroup=null;constructor(n){this.device=n}async initialize(){const n=this.device.createShaderModule({code:q}),r=this.device.createShaderModule({code:H});this.uniformBuffer=this.device.createBuffer({size:160,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const s=await fetch("./src/assets/textures/metallic.png"),i=await createImageBitmap(await s.blob());this.metallicTexture=this.device.createTexture({size:[i.width,i.height,1],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),this.device.queue.copyExternalImageToTexture({source:i},{texture:this.metallicTexture},[i.width,i.height]);const o=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"unfilterable-float"}}]}),c=this.device.createSampler({magFilter:"linear",minFilter:"linear",mipmapFilter:"linear",addressModeU:"repeat",addressModeV:"repeat"});this.bindGroup=this.device.createBindGroup({layout:o,entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:c},{binding:2,resource:this.metallicTexture.createView()}]}),this.pipeline=this.device.createRenderPipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[o]}),vertex:{module:n,entryPoint:"vs_main",buffers:[{arrayStride:32,attributes:[{format:"float32x3",offset:0,shaderLocation:0},{format:"float32x3",offset:12,shaderLocation:1},{format:"float32x2",offset:24,shaderLocation:2}]}]},fragment:{module:r,entryPoint:"fs_main",targets:[{format:"bgra8unorm"}]},primitive:{topology:"triangle-list",cullMode:"back"}})}updateUniforms(n,r,s,i){if(!this.uniformBuffer)return;const o=new Float32Array(40);o.set(n,0),o.set(r,16),o[32]=s,o.set(i,33),this.device.queue.writeBuffer(this.uniformBuffer,0,o.buffer)}render(n,r,s,i){!this.pipeline||!this.bindGroup||(n.setPipeline(this.pipeline),n.setBindGroup(0,this.bindGroup),n.setVertexBuffer(0,r),n.setIndexBuffer(s,"uint16"),n.drawIndexed(i))}}class Q{device=null;context=null;canvas;fallbackToWebGL=!1;webglContext=null;sandstoneMaterial=null;quadVertexBuffer=null;quadIndexBuffer=null;depthTexture=null;constructor(n){this.canvas=n}async initialize(){try{if("gpu"in navigator&&navigator.gpu){const n=navigator.gpu,r=await n.requestAdapter();if(r&&(this.device=await r.requestDevice(),this.context=this.canvas.getContext("webgpu"),this.context&&this.device))return this.context.configure({device:this.device,format:n.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.sandstoneMaterial=new $(this.device),await this.sandstoneMaterial.initialize(),this.createFullScreenQuad(),!0}}catch{}return this.initializeWebGL()}initializeWebGL(){try{if(this.webglContext=this.canvas.getContext("webgl2")||this.canvas.getContext("webgl"),this.webglContext)return this.fallbackToWebGL=!0,this.webglContext.enable(this.webglContext.DEPTH_TEST),this.webglContext.enable(this.webglContext.CULL_FACE),!0}catch{}return!1}render(n,r,s){this.fallbackToWebGL?this.renderWebGL(n,r,s):this.renderWebGPU(n,r,s)}renderWebGPU(n,r,s){if(!this.device||!this.context)return;const i=this.device.createCommandEncoder(),c={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"}]},a=i.beginRenderPass(c);if(this.sandstoneMaterial&&this.quadVertexBuffer&&this.quadIndexBuffer){const l=performance.now()/1e3,m=new Float32Array([2,5,10]),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),u=new Float32Array(16);u.set([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.sandstoneMaterial.updateUniforms(u,f,l,m),this.sandstoneMaterial.render(a,this.quadVertexBuffer,this.quadIndexBuffer,6)}for(const l of n)this.renderObjectWebGPU(a,l,r,s);a.end(),this.device.queue.submit([i.finish()])}renderObjectWebGPU(n,r,s,i){r.mesh}createFullScreenQuad(){if(!this.device)return;const n=new Float32Array([-1,-1,.999,0,0,1,0,1,1,-1,.999,0,0,1,1,1,1,1,.999,0,0,1,1,0,-1,1,.999,0,0,1,0,0]),r=new Uint16Array([0,1,2,0,2,3]);this.quadVertexBuffer=this.device.createBuffer({size:n.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0}),new Float32Array(this.quadVertexBuffer.getMappedRange()).set(n),this.quadVertexBuffer.unmap(),this.quadIndexBuffer=this.device.createBuffer({size:r.byteLength,usage:GPUBufferUsage.INDEX,mappedAtCreation:!0}),new Uint16Array(this.quadIndexBuffer.getMappedRange()).set(r),this.quadIndexBuffer.unmap()}renderWebGL(n,r,s){if(!this.webglContext)return;const i=this.webglContext;i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.viewport(0,0,this.canvas.width,this.canvas.height);for(const o of n)this.renderObjectWebGL(o,r,s)}renderObjectWebGL(n,r,s){this.webglContext}resize(n,r){this.canvas.width=n,this.canvas.height=r,this.isWebGPU()&&this.device&&this.context&&(this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture({size:[n,r],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT})),this.fallbackToWebGL&&this.webglContext&&this.webglContext.viewport(0,0,n,r)}dispose(){this.device&&this.device.destroy(),this.device=null,this.context=null,this.webglContext=null}isWebGPU(){return!this.fallbackToWebGL&&this.device!==null}isWebGL(){return this.fallbackToWebGL&&this.webglContext!==null}}function J(t,n,r,s){const i=1/Math.tan(t/2),o=1/(r-s);return new Float32Array([i/n,0,0,0,0,i,0,0,0,0,(s+r)*o,-1,0,0,2*s*r*o,0])}function Z(t,n,r){const s=K(ee(t,n)),i=K(z(r,s)),o=z(s,i);return new Float32Array([i[0],o[0],s[0],0,i[1],o[1],s[1],0,i[2],o[2],s[2],0,-N(i,t),-N(o,t),-N(s,t),1])}function ee(t,n){return[t[0]-n[0],t[1]-n[1],t[2]-n[2]]}function z(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function N(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function K(t){const n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return n>0?[t[0]/n,t[1]/n,t[2]/n]:[0,0,0]}const G=d.forwardRef(({src:t="/latest/kasm_canvas_jog_obs.html",title:n="Jog Canvas",width:r=150,height:s=150,style:i={},midiData:o},c)=>{const a=d.useRef(null);return d.useEffect(()=>{o&&a.current&&a.current.contentWindow&&a.current.contentWindow.postMessage({type:"MIDI_DATA",...o},"*")},[o]),d.useImperativeHandle(c,()=>({callKasmFunction:(l,m)=>{a.current&&a.current.contentWindow&&a.current.contentWindow.postMessage({type:"KASM",func:l,args:m},"*")}})),e.jsx("iframe",{ref:a,src:t,title:n,width:r,height:s,style:{border:"1px solid #ccc",borderRadius:"8px",...i}})}),te=()=>{const t=d.useRef(null);return d.useEffect(()=>{function n(){const a=Math.floor(8)+1;return 40+5*Math.floor(Math.random()*a)}const r=100,s=setInterval(()=>{const i=n(),o=t.current;o&&o.callKasmFunction("update_canvas_data",{pitch:i,velocity:r,cc:!1}),o&&o.callKasmFunction("update_canvas_data",{pitch:i-10,velocity:0,cc:!1})},500);return()=>clearInterval(s)},[]),e.jsxs("p",{children:["New Component in v1.14!",e.jsx("br",{}),"Jog - video jogger canvas kasm_canvas_jog.rs",e.jsx("br",{}),e.jsx(G,{ref:t})]})},I=()=>{const t=d.useRef(null);return d.useEffect(()=>{const n=r=>{t.current&&t.current.contentWindow&&t.current.contentWindow.postMessage({type:"KASM_KEY",key:r.key,code:r.code,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey},"*")};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),e.jsx("div",{style:{marginTop:"2rem",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.current&&t.current.focus()},children:e.jsx("iframe",{ref:t,src:"/latest/emanator.html",title:"Kasm Demo",width:"90%",height:"1024",style:{width:"90vw",height:"90vh",display:"block",border:"2px solid #ccc",borderRadius:"12px",boxShadow:"0 2px 16px rgba(0,0,0,0.12)"},allowFullScreen:!0,tabIndex:-1,onLoad:()=>{t.current&&t.current.focus()}})})};function ne({onNavigate:t}){function n(){const r=Math.floor(Math.random()*200),s=Math.floor(Math.random()*200);return`${r}px ${s}px`}return e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Kasm SDK"}),e.jsx("p",{style:{backgroundPosition:n()},children:"The main intention is interoperability between Web Browsers and DAWs using open standards, in particular to make head way for Augmented Reality glasses and Virtual Reality headset based instruments. The aim is to achieve this by utilising cross platform technologies such as WebAssembly, WebXR, WebGL/WebGPU, WebMIDI and OSC (Open Sound Control)"}),e.jsx("p",{style:{backgroundPosition:n()},children:"The collection has zero formal roadmap, there is no rule book here as to what's right or wrong way, there will certainly be better ways of doing things, but it's a start. The common goal here is ease of open patching and sharing of editor tools to support the many different use cases and musical genres"}),e.jsx("div",{style:{backgroundPosition:n()},children:e.jsxs("div",{className:"kasm-demo-buttons",children:[e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("emanator"),children:["🎹 ",e.jsx("br",{}),"Emanator"]}),e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("bangaz"),children:["🎹 ",e.jsx("br",{}),"Bangaz"]}),e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("arpy"),children:["🎹 ",e.jsx("br",{}),"Arpy"]}),e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("triggaz"),children:["🎹 ",e.jsx("br",{}),"Triggaz"]}),e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("lfo"),children:["🎹 ",e.jsx("br",{}),"MIDI LFO"]}),e.jsxs("button",{className:"kasm-demo-btn",onClick:()=>t("looper"),children:["🎛️ ",e.jsx("br",{}),"MIDI Looper"]})]})}),e.jsx(te,{}),e.jsx(I,{})]})}function re(){const t=d.useRef(null),[n,r]=d.useState({protocol:"TechWebMIDI",latency:"45ms",throughput:"125 Mbps",objects:1247,subscribers:8,publishers:3,quality:"Ultra Low Latency"});return R(()=>{r(s=>({...s,latency:`${(40+Math.sin(Date.now()*.001)*10).toFixed(0)}ms`,throughput:`${(120+Math.sin(Date.now()*.0015)*20).toFixed(0)} Mbps`,objects:s.objects+Math.floor(Math.random()*3),subscribers:8+Math.floor(Math.sin(Date.now()*.002)*2),publishers:3+Math.floor(Math.cos(Date.now()*.0025)*1)}))}),e.jsxs("group",{position:[0,0,-2],children:[e.jsx(h,{ref:t,position:[0,.8,0],fontSize:.25,color:"#00ff00",anchorX:"center",anchorY:"middle",children:"WebMIDI"}),e.jsxs(h,{position:[0,.4,0],fontSize:.12,color:"#ffff00",anchorX:"center",anchorY:"middle",children:["Protocol: ",n.protocol," | Quality: ",n.quality]}),e.jsxs(h,{position:[0,.2,0],fontSize:.1,color:"#ff6600",anchorX:"center",anchorY:"middle",children:["Latency: ",n.latency," | Throughput: ",n.throughput]}),e.jsxs(h,{position:[0,0,0],fontSize:.1,color:"#00ffff",anchorX:"center",anchorY:"middle",children:["Objects: ",n.objects," | Subscribers: ",n.subscribers]}),e.jsxs(h,{position:[0,-.2,0],fontSize:.1,color:"#ff00ff",anchorX:"center",anchorY:"middle",children:["Publishers: ",n.publishers]}),e.jsx(h,{position:[0,-.5,0],fontSize:.08,color:"#888888",anchorX:"center",anchorY:"middle",children:"Ultra-low latency media streaming over QUIC"})]})}function se(){const t=d.useRef(null),n=d.useRef(null),r=d.useRef([]),s=d.useRef(null);return R(()=>{const i=Date.now()*.001;if(t.current&&(t.current.rotation.y=i*.4,t.current.scale.setScalar(1+Math.sin(i*2)*.1)),n.current&&(n.current.rotation.x=i*.3,n.current.rotation.z=i*.2),r.current.forEach((o,c)=>{o&&(o.rotation.y=i*(.5+c*.1),o.position.y=Math.sin(i*(1+c*.3))*.1)}),s.current){s.current.position.x=Math.sin(i*3)*.4;const o=s.current.material;o&&"opacity"in o&&(o.opacity=.7+Math.sin(i*5)*.2)}}),e.jsxs("group",{position:[2,0,-2],children:[e.jsx(W,{ref:t,args:[.3,.3,.3],position:[-.8,.4,0],children:e.jsx("meshBasicMaterial",{color:"#00ff00"})}),e.jsx(U,{ref:n,args:[.2,16,16],position:[0,.2,0],children:e.jsx("meshBasicMaterial",{color:"#ffff00"})}),e.jsx(X,{ref:s,args:[.6,.03],position:[0,.4,0],children:e.jsx("meshBasicMaterial",{color:"#00ffff",transparent:!0})}),[0,1,2].map(i=>e.jsx(W,{ref:o=>{o&&(r.current[i]=o)},args:[.2,.2,.2],position:[.6+i*.3,-.2-i*.2,0],children:e.jsx("meshBasicMaterial",{color:"#ff6600"})},i)),e.jsx(h,{position:[-.8,.1,0],fontSize:.06,color:"#00ff00",anchorX:"center",anchorY:"middle",children:"Publisher"}),e.jsx(h,{position:[0,-.1,0],fontSize:.06,color:"#ffff00",anchorX:"center",anchorY:"middle",children:"WebMIDI Relay"}),e.jsx(h,{position:[.8,-.6,0],fontSize:.06,color:"#ff6600",anchorX:"center",anchorY:"middle",children:"Subscribers"}),e.jsx(h,{position:[0,-.9,0],fontSize:.08,color:"#ffffff",anchorX:"center",anchorY:"middle",children:"WebMIDI Network"}),e.jsx(h,{position:[0,-1.1,0],fontSize:.06,color:"#888888",anchorX:"center",anchorY:"middle",children:"QUIC Transport"})]})}function ie(){const[t]=d.useState(["🚀 Ultra Low Latency","📦 Object-based Delivery","🔄 Adaptive Bitrate","🌐 CDN Integration","📱 Multi-device Sync","🔒 Built-in Security"]),[n]=d.useState(["Live Streaming","Interactive Media","Gaming Applications","Real-time Collaboration","IoT Data Streams"]);return e.jsxs("group",{position:[-2,0,-2],children:[e.jsx(h,{position:[0,1,0],fontSize:.12,color:"#ffffff",anchorX:"center",anchorY:"middle",children:"WebMIDI Features"}),t.map((r,s)=>e.jsx(h,{position:[0,.6-s*.15,0],fontSize:.07,color:"#00ff88",anchorX:"center",anchorY:"middle",children:r},s)),e.jsx(h,{position:[0,-.5,0],fontSize:.1,color:"#ffff00",anchorX:"center",anchorY:"middle",children:"Use Cases"}),n.map((r,s)=>e.jsxs(h,{position:[0,-.7-s*.1,0],fontSize:.06,color:"#ff6600",anchorX:"center",anchorY:"middle",children:["• ",r]},s))]})}function oe(){return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.5}),e.jsx("pointLight",{position:[10,10,10]}),e.jsx(re,{}),e.jsx(se,{}),e.jsx(ie,{})]})}function ae(){const[t,n]=d.useState({webmidi:!1});return d.useEffect(()=>{(()=>{n({webmidi:!1})})()},[]),e.jsxs("div",{className:"webmidi-container",style:{width:"100%",height:"100vh",position:"relative"},children:[e.jsxs("div",{className:"webmidi-header",style:{position:"absolute",top:"20px",left:"20px",zIndex:10,background:"rgba(0, 0, 0, 0.7)",padding:"1rem",borderRadius:"10px",color:"white"},children:[e.jsx("h2",{children:"📡 WebMIDI"}),e.jsx("p",{children:"Ultra-low latency media streaming protocol"}),e.jsx("p",{style:{fontSize:"0.9em",marginTop:"10px",color:"#aaa"},children:"Object-based media delivery with Rust WebAssembly optimization"}),e.jsx("div",{style:{marginTop:"10px",fontSize:"0.8em"},children:e.jsxs("div",{style:{color:t.webmidi?"#00ff00":"#ffaa00"},children:[t.webmidi?"✅":"🚧"," WebMIDI (Experimental)"]})})]}),e.jsx(F,{camera:{position:[0,0,5],fov:75},style:{background:"linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%)"},children:e.jsx(oe,{})})]})}function ce(){const[t,n]=d.useState("webmidi");d.useEffect(()=>{const i=new URLSearchParams(window.location.search).get("module");i&&["webmidi"].includes(i)&&n(i)},[]);const r=[{id:"webmidi",name:"WebMIDI",icon:"📡",description:"TechWebMIDI"},{id:"webgpu",name:"WebGPU",icon:"📡",description:"WebGPU"}];return e.jsxs("div",{className:"tech-container",style:{width:"100%",height:"100vh",position:"relative"},children:[e.jsxs("div",{className:"tech-selector",style:{position:"absolute",top:"20px",right:"20px",zIndex:20,background:"rgba(0, 0, 0, 0.8)",borderRadius:"15px",padding:"1rem",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{color:"white",marginBottom:"1rem",fontSize:"1.1rem",textAlign:"center"},children:"🔧 Tech Demos"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.map(s=>e.jsx("button",{onClick:()=>n(s.id),style:{background:t===s.id?"rgba(0, 255, 136, 0.2)":"rgba(255, 255, 255, 0.1)",border:t===s.id?"1px solid rgba(0, 255, 136, 0.5)":"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"10px",padding:"0.75rem",color:"white",cursor:"pointer",transition:"all 0.3s ease",fontSize:"0.9rem",minWidth:"180px",textAlign:"left"},onMouseEnter:i=>{t!==s.id&&(i.currentTarget.style.background="rgba(255, 255, 255, 0.2)")},onMouseLeave:i=>{t!==s.id&&(i.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem",color:"var(--sandstone-base)"},children:s.icon}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:s.name}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.8},children:s.description})]})]})},s.id))}),e.jsx("div",{style:{marginTop:"1rem",padding:"0.5rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",fontSize:"0.8rem",color:"#aaa",textAlign:"center"},children:"Giving a home to various tech demos and experiments that might be useful to others."})]}),e.jsx("div",{className:"tech-module-display",style:{width:"100%",height:"100%"},children:t==="webmidi"&&e.jsx(ae,{})}),e.jsxs("div",{className:"tech-info",style:{position:"absolute",bottom:"20px",left:"20px",zIndex:10,background:"rgba(0, 0, 0, 0.7)",padding:"1rem",borderRadius:"10px",color:"white",maxWidth:"300px"},children:[e.jsxs("h4",{style:{marginBottom:"0.5rem",color:"var(--sandstone-base)"},children:[r.find(s=>s.id===t)?.icon," ",r.find(s=>s.id===t)?.name]}),e.jsxs("p",{style:{fontSize:"0.9rem",lineHeight:"1.4",margin:0},children:[t==="webmidi"&&"How TechWebMIDI works, or at least is supposed to.",t==="webgpu"&&"How WebGPU can be used to speed instrument rendering and visualizations up."]})]})]})}function le(){const t=d.useRef(null),[n,r]=d.useState(0),s=[{title:"Kasm XR Experience",subtitle:"Advanced WebXR Platform",description:"Control virtual musical instruments that aren't quite all there"},{title:"Rust WebAssembly Core",subtitle:"High-Performance Computing",description:"Shared WASM foundation across all modules"},{title:"WebXR Innovation",subtitle:"Immersive Experiences",description:"AR/VR capabilities for modern web browsers"}];R(()=>{const o=Date.now(),c=Math.floor(o/3e3%s.length);c!==n&&r(c)});const i=s[n];return e.jsxs("group",{position:[0,0,-2],children:[e.jsx(h,{ref:t,position:[0,.8,0],fontSize:.25,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:i.title}),e.jsx(h,{position:[0,.4,0],fontSize:.15,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:i.subtitle}),e.jsx(h,{position:[0,0,0],fontSize:.12,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:i.description}),e.jsxs(h,{position:[0,-.4,0],fontSize:.08,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:[n+1," / ",s.length]})]})}function de(){const t=d.useRef(null),n=d.useRef(null),r=d.useRef(null);return R(()=>{const s=Date.now()*.001;t.current&&(t.current.rotation.y=s*.5,t.current.position.y=Math.sin(s)*.2),n.current&&(n.current.rotation.x=s*.3,n.current.position.y=Math.cos(s*1.2)*.15),r.current&&(r.current.rotation.z=s*.7,r.current.position.y=Math.sin(s*.8)*.25)}),e.jsxs("group",{position:[2,0,-2],children:[e.jsx(W,{ref:t,args:[.3,.3,.3],position:[0,.5,0],children:e.jsx("meshBasicMaterial",{color:"#ce422b"})}),e.jsx(U,{ref:n,args:[.15,16,16],position:[0,0,0],children:e.jsx("meshBasicMaterial",{color:"#00d4ff"})}),e.jsx(W,{ref:r,args:[.2,.2,.2],position:[0,-.5,0],children:e.jsx("meshBasicMaterial",{color:"#ff6b35"})}),e.jsx(h,{position:[0,-1,0],fontSize:.08,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"Core Technologies"}),e.jsx(h,{position:[0,-1.2,0],fontSize:.06,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"🦀 Rust WebAssembly"}),e.jsx(h,{position:[0,-1.35,0],fontSize:.06,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"🥽 WebXR"}),e.jsx(h,{position:[0,-1.5,0],fontSize:.06,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"⚡ WebGPU"})]})}function ue(){const[t]=d.useState(["🎵 TechWebMIDI Audio Synthesis","🥽 AR/VR MIDI Controllers"]);return e.jsxs("group",{position:[-2,0,-2],children:[e.jsx(h,{position:[0,1,0],fontSize:.12,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"Platform Features"}),t.map((n,r)=>e.jsx(h,{position:[0,.6-r*.2,0],fontSize:.08,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:n},r)),e.jsx(h,{position:[0,-.8,0],fontSize:.06,color:"#fff600",outlineColor:"#fff600",outlineWidth:.01,anchorX:"center",anchorY:"middle",children:"Powered by Rust + WebAssembly"})]})}function fe(){return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.5}),e.jsx("pointLight",{position:[10,10,10]}),e.jsx(le,{}),e.jsx(de,{}),e.jsx(ue,{})]})}function he(){return e.jsxs("div",{className:"about-container",style:{width:"100%",height:"100vh",position:"relative"},children:[e.jsxs("div",{className:"about-header",style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",zIndex:10,maxWidth:"800px",width:"90%",color:"white",textAlign:"center"},children:[e.jsx("h2",{children:"About"}),e.jsx("p",{children:"Kasm SDK Open Source Community"}),e.jsx("p",{style:{fontSize:"0.9em",marginTop:"10px",color:"#aaa"},children:"Kasm SDK is an open source community project focused on building advanced web based musical instruments including AR and VR instruments and MIDI controllers"})]}),e.jsx(F,{camera:{position:[0,0,5],fov:75},style:{},children:e.jsx(fe,{})})]})}const pe=({currentApp:t,onAppChange:n,appContext:r="main",onFilterChange:s})=>{const[i,o]=d.useState(!1),a=(()=>{switch(r){case"kasm":default:return[{id:"kasm",label:"Kasm SDK",icon:"🎹",description:"Documentatin for the Kasm SDK"},{id:"emanator",label:"Emanator",icon:"🎹",description:"Emanator editor tool"},{id:"bangaz",label:"Bangaz",icon:"🎹",description:"Drum Machine pattern editor tool"},{id:"arpy",label:"Arpy",icon:"🎹",description:"Arpeggiaor editor tool"},{id:"triggaz",label:"Triggaz",icon:"🎹",description:"MIDI note/cc pattern detection"},{id:"lfo",label:"LFO",icon:"🎹",description:"Low Frequecy Oscillators editor"}]}})(),l=f=>{if(r!=="main"&&s)s(f);else{n(f);const u=f;let y;switch(u){case"kasm":y=[{id:"kasm_emanator"},{id:"oscillators"},{id:"kasm_lfo"},{id:"effects"},{id:"kasm_canvas"},{id:"kasm_jog"},{id:"kasm_emanator_trans"}];break;case"tech":y=[{id:"webmidi"},{id:"webgpu"}];break;default:y=[]}y.length===0&&o(!1)}},m=()=>{n&&n("bangaz")};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`hamburger-menu${i?" open":""}`,onClick:()=>o(!i),"aria-label":"Toggle navigation menu","aria-expanded":i,children:[e.jsx("span",{className:"hamburger-line"}),e.jsx("span",{className:"hamburger-line"}),e.jsx("span",{className:"hamburger-line"})]}),i&&e.jsx("div",{className:"sidebar-overlay",onClick:()=>o(!1)}),e.jsx("nav",{className:`sidebar${i?" open":""}`,children:e.jsxs("div",{className:"sidebar-content",children:[e.jsx("div",{className:"sidebar-header"}),r!=="main"&&e.jsx("div",{className:"sidebar-back-main",children:e.jsx("button",{className:"nav-link-back",style:{width:"100%",marginBottom:"1em",color:"#ffffff",fontWeight:"bold",borderRadius:0},onClick:m,children:"← Back to Main"})}),e.jsx("div",{className:"sidebar-nav",children:e.jsx("ul",{className:"nav-list",children:a.map(f=>e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:`nav-link ${t===f.id?"active":""}`,onClick:()=>l(f.id),"aria-current":t===f.id?"page":void 0,children:[e.jsx("span",{className:"nav-icon",children:f.icon}),e.jsxs("div",{className:"nav-content",children:[e.jsx("span",{className:"nav-label",children:f.label}),e.jsx("span",{className:"nav-description",children:f.description})]})]})},f.id))})})]})})]})},C=({onDeviceChange:t,onChannelChange:n,initialDeviceId:r="",initialChannel:s=0})=>{const[i,o]=d.useState([]),[c,a]=d.useState(r),[l,m]=d.useState(s),f=()=>{navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then(j=>{const x=[];j.outputs.forEach(M=>{x.push({id:M.id,name:M.name??"Unknown Device"})}),o(x)}).catch(()=>o([]))};d.useEffect(()=>{f()},[]);const u=j=>{a(j.target.value);const x=window;x.kasmWebMIDI&&x.kasmWebMIDI.setCurrentMidiOutput(j.target.value),t&&t(j.target.value)},y=j=>{const x=Number(j.target.value);m(x),n&&n(x)};return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{children:e.jsxs("select",{style:{padding:"3px",marginLeft:"10px"},value:c,onChange:u,children:[e.jsx("option",{value:"",children:"Select MIDI Device..."}),i.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})}),e.jsx("button",{style:{marginLeft:"10px",padding:"3px 8px"},onClick:f,children:"<"}),e.jsxs("label",{style:{marginLeft:"20px"},children:["MIDI Channel:",e.jsx("select",{style:{padding:"3px",width:"40px",marginLeft:"10px"},value:l,onChange:y,children:[...Array(16)].map((j,x)=>e.jsx("option",{value:x,children:x+1},x))})]})]})},S=d.forwardRef(({src:t="/latest/kasm_canvas_obs.html",title:n="LFO Canvas",width:r=150,height:s=150,style:i={},midiData:o,inlet_5_emanator:c},a)=>{const l=d.useRef(null),m=d.useRef(!1),f=()=>{m.current=!0,typeof c=="number"&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"INLET_5_EMANATOR",value:c},"*")};return d.useEffect(()=>{o&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"MIDI_DATA",...o},"*")},[o]),d.useEffect(()=>{m.current&&typeof c=="number"&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"INLET_5_EMANATOR",value:c},"*")},[c]),d.useImperativeHandle(a,()=>({callKasmFunction:(u,y)=>{l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"KASM",func:u,args:y},"*")},postHello:()=>{const u=l.current?.contentWindow;u&&typeof u.post=="function"&&u.post("Hello, World!")},setInlets:u=>{l.current&&l.current.contentWindow&&u&&(l.current.contentWindow.postMessage({type:"INLET_0_NOTE",value:u.pitch},"*"),l.current.contentWindow.postMessage({type:"INLET_2_VELOCITY",value:u.velocity},"*"),l.current.contentWindow.postMessage({type:"BANG"},"*"))}})),e.jsx("iframe",{ref:l,src:t,title:n,width:r,height:s,style:{border:"1px solid #ccc",borderRadius:"8px",...i},onLoad:f})}),me=()=>{const t=d.useRef(null);return d.useEffect(()=>{const n=r=>{t.current&&t.current.contentWindow&&t.current.contentWindow.postMessage({type:"KASM_KEY",key:r.key,code:r.code,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey},"*")};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),e.jsx("div",{style:{marginTop:"2rem",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.current&&t.current.focus()},children:e.jsx("iframe",{ref:t,src:"/latest/bangaz.html",title:"Kasm Demo",style:{width:"90vw",height:"90vh",display:"block",border:"2px solid #ccc",borderRadius:"12px",boxShadow:"0 2px 16px rgba(0,0,0,0.12)"},allowFullScreen:!0,tabIndex:-1,onLoad:()=>{t.current&&t.current.focus()}})})},B=[0,2,4,5,7,9,11],xe=["C","D","E","F","G","A","B"],O=[0,1,3,4,5],ge=[1,3,6,8,10],be=["C#","Eb","F#","G#","Bb"],_=60,P=2,E={a:0,w:1,s:2,e:3,d:4,f:5,t:6,g:7,y:8,h:9,u:10,j:11,k:12,o:13,l:14,p:15,";":16,"'":17,"]":18,"\\":20},T=({onNoteOn:t,onNoteOff:n,highlightedNotes:r=[],velocity:s=100})=>{const[i,o]=d.useState([]),[c,a]=d.useState(0),[l,m]=d.useState(s),f=d.useRef(new Set);d.useEffect(()=>{m(s)},[s]),d.useEffect(()=>{const g=v=>{const w=v.key.toLowerCase();if(!v.repeat&&!f.current.has(w)){if(f.current.add(w),w==="z"){a(p=>Math.max(p-12,-48));return}if(w==="x"){a(p=>Math.min(p+12,48));return}if(w==="c"){m(p=>Math.max(p-10,1));return}if(w==="v"){m(p=>Math.min(p+10,127));return}if(Object.prototype.hasOwnProperty.call(E,w)){const p=_+E[w]+c;i.includes(p)||(o(D=>[...D,p]),t(p,l),window.kasm_rust&&typeof window.kasm_rust.update_canvas_data=="function"&&window.kasm_rust.update_canvas_data(p,l,!1))}}},b=v=>{const w=v.key.toLowerCase();if(f.current.delete(w),Object.prototype.hasOwnProperty.call(E,w)){const p=_+E[w]+c;o(D=>D.filter(Y=>Y!==p)),n(p),window.kasm_rust&&typeof window.kasm_rust.update_canvas_data=="function"&&window.kasm_rust.update_canvas_data(p,0,!1)}};return window.addEventListener("keydown",g),window.addEventListener("keyup",b),()=>{window.removeEventListener("keydown",g),window.removeEventListener("keyup",b)}},[c,l,i,t,n]);const u=g=>{i.includes(g)||(o(b=>[...b,g]),t(g,l),window.kasm_rust&&typeof window.kasm_rust.update_canvas_data=="function"&&window.kasm_rust.update_canvas_data(g,l,!1))},y=g=>{o(b=>b.filter(v=>v!==g)),n(g),window.kasm_rust&&typeof window.kasm_rust.update_canvas_data=="function"&&window.kasm_rust.update_canvas_data(g,0,!1)},j=[],x=40,M=24,L=100,k=160;for(let g=0;g<P;g++){for(let b=0;b<B.length;b++){const v=_+g*12+B[b],w=(g*7+b)*x;j.push(e.jsxs("g",{children:[e.jsx("rect",{x:w,y:0,width:x,height:k,fill:i.includes(v)||r.includes(v)?"lime":"white",stroke:"#333",strokeWidth:1,onMouseDown:()=>u(v),onMouseUp:()=>y(v),onMouseLeave:()=>y(v),onTouchStart:()=>u(v),onTouchEnd:()=>y(v),style:{cursor:"pointer"}}),e.jsx("text",{x:w+x/2,y:150,textAnchor:"middle",fontSize:14,fill:"#666",children:xe[b]})]},`w${g}-${b}`))}for(let b=0;b<O.length;b++){const v=O[b],w=(g*7+v)*x+x-M/2,p=_+g*12+ge[b];j.push(e.jsxs("g",{children:[e.jsx("rect",{x:w,y:0,width:M,height:L,fill:i.includes(p)||r.includes(p)?"#fbc02d":"#333",stroke:"#000",strokeWidth:1,onMouseDown:()=>u(p),onMouseUp:()=>y(p),onMouseLeave:()=>y(p),onTouchStart:()=>u(p),onTouchEnd:()=>y(p),style:{cursor:"pointer"}}),e.jsx("text",{x:w+M/2,y:90,textAnchor:"middle",fontSize:10,fill:"#fff",children:be[b]})]},`b${g}-${b}`))}}return e.jsx("svg",{width:P*7*x,height:k,style:{userSelect:"none",display:"block",background:"#f0f0f0",borderRadius:8,border:"2px solid #333"},children:j})},ye=10,we=()=>{const[t,n]=d.useState(null),r=Array.from({length:ye},()=>A.createRef()),s=d.useRef(r),i=(c,a)=>{window.inlet_5_emanator="1",n({note:c,velocity:a,isCC:!1}),s.current.forEach(l=>{l.current&&(l.current.callKasmFunction("update_canvas_data",{pitch:c,velocity:a,cc:!1}),l.current.postHello())})},o=c=>{n({note:c,velocity:0,isCC:!1}),s.current.forEach(a=>{a.current&&a.current.callKasmFunction("update_canvas_data",{pitch:c,velocity:0,cc:!1})})};return e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{className:"main-title",children:"Bangaz Drum Pattern Browser and Editor"}),e.jsx("p",{children:"Bangaz are a collection step sequences meant to be played out General MIDI Drum kits and Ableton Drum Racks Drum patterns are effectively emanators, where the current step is expected to map musically and consistently over time"}),e.jsx(me,{}),e.jsxs("p",{children:["Pattern gallery/browser",e.jsx("br",{}),s.current.map((c,a)=>e.jsx(S,{ref:c,title:`Bangaz Canvas ${a+1}`,midiData:t},a))]}),e.jsx(C,{}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx(T,{onNoteOn:i,onNoteOff:o})})]})},je=60,ve=()=>{const[t,n]=d.useState(null),r=Array.from({length:je},()=>A.createRef()),s=d.useRef(r),i=(c,a)=>{n({note:c,velocity:a,isCC:!1}),s.current.forEach(l=>{l.current&&l.current.setInlets({pitch:c,velocity:a,cc:!1})})},o=c=>{n({note:c,velocity:0,isCC:!1}),s.current.forEach(a=>{a.current&&a.current.setInlets({pitch:c,velocity:0,cc:!1})})};return e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Emanator MIDI Pattern Browser and Editor Tool"}),e.jsx("p",{children:"Emanator is a collection of MIDI note patterns with CC articulations that continue playing, the concept of emanators is used in other contexts such as arpeggiators, and loops as they are all have similar results"}),e.jsx(I,{}),e.jsxs("p",{children:["Pattern gallery/browser",e.jsx("br",{}),s.current.map((c,a)=>e.jsx(S,{ref:c,title:`Emanator ${a+1}`,midiData:t,inlet_5_emanator:a},a))]}),e.jsx(C,{}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx(T,{onNoteOn:i,onNoteOff:o})}),e.jsx("p",{children:"What is an emanator? Effectively it is a Rust function that is called upon to generate notes, each Emanator function has some common parameters like the root note and velocity to go on and a couple of generic encoders that change purpose depending on what the emanator is expected to do"}),e.jsxs("p",{children:["The file structure of Emanators is as follows, again there is no right or wrong way here...",e.jsxs("ul",{children:[e.jsx("li",{children:"arpeggiation.rs"}),e.jsx("li",{children:"experimental.rs"}),e.jsx("li",{children:"lfo.rs"}),e.jsx("li",{children:"mathematical.rs"}),e.jsx("li",{children:"mod.rs"}),e.jsx("li",{children:"responsorial.rs"}),e.jsx("li",{children:"spatial.rs"}),e.jsx("li",{children:"drumpattern.rs"}),e.jsx("li",{children:"harmonic.rs"}),e.jsx("li",{children:"loopcounterpoint.rs"}),e.jsx("li",{children:"melodic.rs"}),e.jsx("li",{children:"progressions.rs"}),e.jsx("li",{children:"rhythmic.rs"})]})]})]})},Me=d.forwardRef(({src:t="/latest/kasm_canvas_arpy_obs.html",title:n="LFO Canvas",width:r=150,height:s=150,style:i={},midiData:o,inlet_5_emanator:c},a)=>{const l=d.useRef(null),m=d.useRef(!1),f=()=>{m.current=!0,typeof c=="number"&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"INLET_5_EMANATOR",value:c},"*")};return d.useEffect(()=>{o&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"MIDI_DATA",...o},"*")},[o]),d.useEffect(()=>{m.current&&typeof c=="number"&&l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"INLET_5_EMANATOR",value:c},"*")},[c]),d.useImperativeHandle(a,()=>({callKasmFunction:(u,y)=>{l.current&&l.current.contentWindow&&l.current.contentWindow.postMessage({type:"KASM",func:u,args:y},"*")},postHello:()=>{const u=l.current?.contentWindow;u&&typeof u.post=="function"&&u.post("Hello, World!")},setInlets:u=>{l.current&&l.current.contentWindow&&u&&(l.current.contentWindow.postMessage({type:"INLET_0_NOTE",value:u.pitch},"*"),l.current.contentWindow.postMessage({type:"INLET_2_VELOCITY",value:u.velocity},"*"),l.current.contentWindow.postMessage({type:"BANG"},"*"))}})),e.jsx("iframe",{ref:l,src:t,title:n,width:r,height:s,style:{border:"1px solid #ccc",borderRadius:"8px",...i},onLoad:f})}),Ie=16,Se=()=>{const[t,n]=d.useState(null),r=Array.from({length:Ie},()=>A.createRef()),s=d.useRef(r),i=(c,a)=>{n({note:c,velocity:a,isCC:!1}),s.current.forEach(l=>{l.current&&l.current.setInlets({pitch:c,velocity:a,cc:!1})})},o=c=>{n({note:c,velocity:0,isCC:!1}),s.current.forEach(a=>{a.current&&a.current.setInlets({pitch:c,velocity:0,cc:!1})})};return e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Arpy MIDI Pattern Browser and Editor Tool"}),e.jsx("p",{children:"Arpy is a collection of MIDI note patterns with CC articulations that continue playing, the concept of emanators is used in other contexts such as arpeggiators, and loops as they are all have similar results"}),e.jsx(I,{}),e.jsxs("p",{style:{maxHeight:"400px",overflowY:"auto",display:"block"},children:["Pattern gallery/browser",e.jsx("br",{}),s.current.map((c,a)=>e.jsx(Me,{ref:c,title:`Arpy ${a+1}`,midiData:t,inlet_5_emanator:a},a))]}),e.jsx(C,{}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx(T,{onNoteOn:i,onNoteOff:o})}),e.jsx("p",{children:"What is an emanator? Effectively it is a Rust function that is called upon to generate notes, each Arpy function has some common parameters like the root note and velocity to go on and a couple of generic encoders that change purpose depending on what the emanator is expected to do"}),e.jsxs("p",{children:["The file structure of Arpys is as follows, again there is no right or wrong way here...",e.jsxs("ul",{children:[e.jsx("li",{children:"arpeggiation.rs"}),e.jsx("li",{children:"experimental.rs"}),e.jsx("li",{children:"lfo.rs"}),e.jsx("li",{children:"mathematical.rs"}),e.jsx("li",{children:"mod.rs"}),e.jsx("li",{children:"responsorial.rs"}),e.jsx("li",{children:"spatial.rs"}),e.jsx("li",{children:"drumpattern.rs"}),e.jsx("li",{children:"harmonic.rs"}),e.jsx("li",{children:"loopcounterpoint.rs"}),e.jsx("li",{children:"melodic.rs"}),e.jsx("li",{children:"progressions.rs"}),e.jsx("li",{children:"rhythmic.rs"})]})]})]})},Ce=()=>e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Triggaz midi note/cc pattern detection tool"}),e.jsx("p",{children:"Triggaz are a bit like Emanators in reverse, they look for patterns in the live performance and when a close enough match has been made it triggers an emanator, or a MIDI CC event or Ableton Live mapped parameter and so on"}),e.jsx("p",{children:"Demo: Try playing Twinkle Twinkle little Star, Three blind Mice, Merrily we Roll Along..."}),e.jsx(I,{}),e.jsx("p",{children:"Triggaz detection pattern browser/gallery and web based pattern learning tools are coming here soon..."}),e.jsx(C,{}),e.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center",margin:"40px 0"},children:[e.jsx(S,{title:"Triggaz 1"}),e.jsx(S,{title:"Triggaz 2"}),e.jsx(S,{title:"Triggaz 3"})]})]}),ke=d.forwardRef(({src:t="/latest/kasm_canvas_obs.html",title:n="LFO Canvas",width:r=150,height:s=150,style:i={},midiData:o},c)=>{const a=d.useRef(null);return d.useEffect(()=>{o&&a.current&&a.current.contentWindow&&a.current.contentWindow.postMessage({type:"MIDI_DATA",...o},"*")},[o]),d.useImperativeHandle(c,()=>({callKasmFunction:(l,m)=>{a.current&&a.current.contentWindow&&a.current.contentWindow.postMessage({type:"KASM",func:l,args:m},"*")},postHello:()=>{a.current&&a.current.contentWindow&&typeof a.current.contentWindow.post=="function"&&a.current.contentWindow.post("HELLO")}})),e.jsx("iframe",{ref:a,src:t,title:n,width:r,height:s,style:{border:"1px solid #ccc",borderRadius:"8px",...i}})}),_e=()=>{const t=d.useRef(null);return d.useEffect(()=>{const n=r=>{t.current&&t.current.contentWindow&&t.current.contentWindow.postMessage({type:"KASM_KEY",key:r.key,code:r.code,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey},"*")};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),e.jsx("div",{style:{marginTop:"2rem",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.current&&t.current.focus()},children:e.jsx("iframe",{ref:t,src:"/latest/lfo.html",title:"Kasm Demo",style:{width:"90vw",height:"90vh",display:"block",border:"2px solid #ccc",borderRadius:"12px",boxShadow:"0 2px 16px rgba(0,0,0,0.12)"},allowFullScreen:!0,tabIndex:-1,onLoad:()=>{t.current&&t.current.focus()}})})},Ee=10,We=()=>{const[t,n]=d.useState(null),r=Array.from({length:Ee},()=>A.createRef()),s=d.useRef(r),i=(c,a)=>{window.inlet_5_emanator="1",n({note:c,velocity:a,isCC:!1}),s.current.forEach(l=>{l.current&&(l.current.callKasmFunction("update_canvas_data",{pitch:c,velocity:a,cc:!1}),l.current.postHello())})},o=c=>{n({note:c,velocity:0,isCC:!1}),s.current.forEach(a=>{a.current&&a.current.callKasmFunction("update_canvas_data",{pitch:c,velocity:0,cc:!1})})};return e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"LFO Sequence Browser and Editor Tool"}),e.jsx("p",{children:"Low Frequency Oscillators, periodically update MIDI CCs and Ableton Live mapped parameters"}),e.jsx(_e,{}),e.jsxs("p",{children:["Pattern gallery/browser",e.jsx("br",{}),s.current.map((c,a)=>e.jsx(ke,{ref:c,title:`LFO Canvas ${a+1}`,midiData:t},a))]}),e.jsx(C,{}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx(T,{onNoteOn:i,onNoteOff:o})})]})},Re=()=>{const t=d.useRef(null);return d.useEffect(()=>{const n=r=>{t.current&&t.current.contentWindow&&t.current.contentWindow.postMessage({type:"KASM_KEY",key:r.key,code:r.code,altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey},"*")};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),e.jsx("div",{style:{marginTop:"2rem",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},onClick:()=>{t.current&&t.current.focus()},children:e.jsx("iframe",{ref:t,src:"/latest/emanator.html",title:"Kasm Demo",style:{width:"90vw",height:"90vh",display:"block",border:"2px solid #ccc",borderRadius:"12px",boxShadow:"0 2px 16px rgba(0,0,0,0.12)"},allowFullScreen:!0,tabIndex:-1,onLoad:()=>{t.current&&t.current.focus()}})})},Ae=()=>e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Kasm Looper"}),e.jsx("p",{children:"MIDI Tape looping with counterpoint"}),e.jsx(Re,{})]}),Te=()=>e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Kasm Canvas"}),e.jsx("p",{children:"2D/WebGL HTML5 canvas from Rust/WebAssembly (WebGPU coming)"}),e.jsx(I,{})]}),Le=()=>e.jsxs("div",{className:"kasm-landing-container",children:[e.jsx("h1",{children:"Kasm Krumhansel"}),e.jsx("p",{children:"Key/chord detection"}),e.jsx(I,{})]});function De(){const[t,n]=d.useState("kasm"),r=d.useRef(null);d.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("app");a&&["kasm","tech","about","bangaz","arpy","emanator","lfo","looper","jog","canvas","krumhansel"].includes(a)?n(a):a&&["webmidi","webgpu"].includes(a)&&n("tech")},[]);const s=["kasm","emanator","bangaz","arpy","triggaz"].includes(t),i=()=>t==="kasm"?"kasm":t==="tech"?"tech":"main";d.useEffect(()=>{if(!r.current)return;const c=r.current,a=new Q(c);let l;const m=async()=>{await a.initialize()&&(a.resize(window.innerWidth,window.innerHeight),f())},f=()=>{const M=Z([0,0,5],[0,0,0],[0,1,0]),L=window.innerWidth/window.innerHeight,k=J(45*(Math.PI/180),L,.1,100);a.render([],M,k),l=requestAnimationFrame(f)};m();const u=()=>{a.resize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u),cancelAnimationFrame(l),a.dispose()}},[]);const o=c=>{n(c)};return e.jsxs(e.Fragment,{children:[e.jsx("canvas",{ref:r,style:{position:"fixed",top:0,left:0,zIndex:-1,width:"100vw",height:"100vh"}}),e.jsxs("div",{className:"App",children:[e.jsx(pe,{currentApp:t,onAppChange:o,appContext:i()}),e.jsxs("div",{className:`app-content ${s?"standalone-mode":""}`,children:[t==="bangaz"&&e.jsx(we,{}),t==="arpy"&&e.jsx(Se,{}),t==="triggaz"&&e.jsx(Ce,{}),t==="kasm"&&e.jsx(ne,{onNavigate:o}),t==="emanator"&&e.jsx(ve,{}),t==="tech"&&e.jsx(ce,{}),t==="about"&&e.jsx(he,{}),t==="lfo"&&e.jsx(We,{}),t==="looper"&&e.jsx(Ae,{}),t==="jog"&&e.jsx(G,{}),t==="canvas"&&e.jsx(Te,{}),t==="krumhansel"&&e.jsx(Le,{})]})]})]})}V.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(De,{})}));
